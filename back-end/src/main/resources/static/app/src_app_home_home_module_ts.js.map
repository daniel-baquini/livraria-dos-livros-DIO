{"version":3,"file":"src_app_home_home_module_ts.js","mappings":";;;;;;;;;;;;;;;;;;ICUQ,2EAAuF;IAAA,0EAAe;IAAA,4DAAO;;;IAVrH,wEAAgC;IAC5B,yEAAwB;IACpB,oEAAwD;IAC5D,4DAAM;IACN,yEAAuB;IAE+B,uDAAmB;IAAA,4DAAO;IACxE,0EAAgD;IAAA,uDAAoB;IAAA,4DAAO;IAE/E,0EAA+C;IAAA,wDAAuB;IAAA,2EAA8B;IAAA,wDAAyB;IAAA,4DAAO;IACpI,mIAA6G;IACjH,4DAAM;IACV,qEAAe;;;IAVkB,0DAA8B;IAA9B,sJAA8B;IAIL,0DAAmB;IAAnB,kFAAmB;IACjB,0DAAoB;IAApB,mFAAoB;IAEzB,0DAAuB;IAAvB,+FAAuB;IAA8B,0DAAyB;IAAzB,iGAAyB;IACtE,0DAA8B;IAA9B,4FAA8B;;ADFtF,MAAM,oBAAoB;IAI7B,IAAI,eAAe;QACf,IAAG,CAAC,IAAI,CAAC,IAAI;YAAE,OAAO,EAAE,CAAC;QAEzB,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,GAAC,GAAG,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC;IAC/F,CAAC;IAED,IAAI,WAAW;QACX,IAAG,CAAC,IAAI,CAAC,IAAI;YAAE,OAAO,CAAC,CAAC;QAExB,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IACvC,CAAC;;wFAdQ,oBAAoB;kHAApB,oBAAoB;QCRjC,mIAYe;;QAZA,0EAAe;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACImD;;;;;;;;;;;ICIzE,iFAIoB;;;IAHhB,yEAAa;;;;IAKrB,0EAIC;IAFG,8RAAS,2EAAe,KAAC;IAE5B,wEAAa;IAAA,4DAAO;;;;IAEzB,gFAMC;IALG,8TAAoB,mFAAuB,KAAC;IAK/C,4DAAY;;IAJT,yFAAgC;;ADX7B,MAAM,iBAAiB;IAO1B,YACY,WAAwB,EACxB,sBAA8C;QAD9C,gBAAW,GAAX,WAAW,CAAa;QACxB,2BAAsB,GAAtB,sBAAsB,CAAwB;QAP1D,UAAK,GAAW,EAAE,CAAC;QACnB,gBAAW,GAAY,KAAK,CAAC;QAEZ,cAAS,GAAW,CAAC,CAAC;QAMnC,IAAI,CAAC,QAAQ,EAAE,CAAC;IACpB,CAAC;IAED,IAAI,gBAAgB;QAChB,OAAO,IAAI,CAAC,sBAAsB,CAAC,eAAe,CAAC,gBAAgB,CAAC;IACxE,CAAC;IAED,gBAAgB;QACZ,IAAI,CAAC,sBAAsB,CAAC,WAAW,CAAC,kBAAkB,EAAE,KAAK,CAAC,CAAC;IACvE,CAAC;IAED,QAAQ;QACJ,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,GAAC,IAAI,CAAC,SAAS,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE;YACrE,IAAG,CAAC,KAAK,SAAS,EAAE;gBAChB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;gBACtB,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC;aACrC;QACL,CAAC,CAAC,CAAC;IACP,CAAC;IAED,QAAQ,CAAC,KAAY;QACjB,MAAM,KAAK,GAAY,KAAK,CAAC,MAA2B,CAAC,KAAK;QAE9D,IAAG,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;YACjB,IAAI,CAAC,aAAa,GAAG,SAAS,CAAC;YAC/B,OAAO;SACV;QAED,wCAAE,CAAC,KAAK,CAAC,CAAC,IAAI,CACV,kDAAY,CAAC,GAAG,CAAC,EACjB,0DAAoB,EAAE,EACtB,gDAAS,CAAC,UAAU,CAAC,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,CAC/D,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE;YACZ,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC;QAC3B,CAAC,CAAC;IACN,CAAC;;kFA9CQ,iBAAiB;+GAAjB,iBAAiB;QCX9B,mFAAkB;QAEoC,wHAAwD;QAAA,4DAAO;QAC7G,yEAA0B;QACX,gKAAgB,oBAAqB,IAAC;QAAC,4DAAY;QAGtE,yEAAmB;QACf,uIAIoB;QACxB,4DAAM;QACN,+GAIqB;QACzB,4DAAmB;QACnB,yHAMa;;;QAhBgB,0DAAqC;QAArC,0JAAqC;QAOzD,0DAA0D;QAA1D,oHAA0D;QAQ9D,0DAA2B;QAA3B,sFAA2B;;;;;;;;;;;;;;;;;;;;;ACzB6C;AACT;AAEb;AACA;;;AAEvD,MAAM,UAAU,GAAW;IACvB;QACI,SAAS,EAAE,6EAAiB;QAC5B,IAAI,EAAE,EAAE;KACX;CACJ,CAAC;AAYK,MAAM,UAAU;;oEAAV,UAAU;uGAAV,UAAU;2GAJf,kEAAqB,CAAC,UAAU,CAAC;QACjC,+DAAY;mIAGP,UAAU,mBARf,sFAAoB;QACpB,6EAAiB,wEAIjB,+DAAY;;;;;;;;;;;;;;;;;ACjBpB,MAAM,sBAAsB,GAAoB;IAC5C,gBAAgB,EAAE,IAAI;CACzB;AAKM,MAAM,sBAAsB;IAI/B;QAFgB,uBAAkB,GAAW,kBAAkB,CAAC;QAG5D,MAAM,qBAAqB,GAAkB,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;QAC3F,IAAI,eAAgC,CAAC;QAErC,IAAG,qBAAqB,KAAK,IAAI,EAAE;YAC/B,eAAe,GAAG,sBAAsB,CAAC;SAC5C;aACI;YACD,eAAe,GAAG,IAAI,CAAC,KAAK,CAAC,qBAAqB,CAAC,CAAC;YACpD,IAAI,GAAwC,CAAC;YAE7C,0FAA0F;YAC1F,gCAAgC;YAChC,KAAI,GAAG,IAAI,sBAAsB,EAAE;gBAC/B,IAAG,CAAC,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;oBAC5C,eAAe,CAAC,GAAG,CAAC,GAAG,sBAAsB,CAAC,GAAG,CAAC,CAAC;iBACtD;aACJ;SACJ;QAED,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,kBAAkB,EAAE,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC,CAAC,CAAC;IACnF,CAAC;IAED,IAAI,eAAe;QACf,uFAAuF;QACvF,OAAO,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,kBAAkB,CAAE,CAAC;IACrE,CAAC;IAED,WAAW,CAAkC,YAAe,EAAE,KAAyB;QACnF,MAAM,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC;QAC7C,eAAe,CAAC,YAAY,CAAC,GAAG,KAAK,CAAC;QAEtC,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,kBAAkB,EAAE,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC,CAAC,CAAC;IACnF,CAAC;;4FArCQ,sBAAsB;uHAAtB,sBAAsB,WAAtB,sBAAsB,mBAFnB,MAAM;;;;;;;;;;;;;;;;;;ACRtB;AACA;AACA;AACO,SAASG,YAAT,CAAsBC,OAAtB,EAA+BC,SAAS,GAAGL,4DAA3C,EAA2D;EAC9D,OAAOC,mDAAO,CAAC,CAACK,MAAD,EAASC,UAAT,KAAwB;IACnC,IAAIC,UAAU,GAAG,IAAjB;IACA,IAAIC,SAAS,GAAG,IAAhB;IACA,IAAIC,QAAQ,GAAG,IAAf;;IACA,MAAMC,IAAI,GAAG,MAAM;MACf,IAAIH,UAAJ,EAAgB;QACZA,UAAU,CAACI,WAAX;QACAJ,UAAU,GAAG,IAAb;QACA,MAAMK,KAAK,GAAGJ,SAAd;QACAA,SAAS,GAAG,IAAZ;QACAF,UAAU,CAACO,IAAX,CAAgBD,KAAhB;MACH;IACJ,CARD;;IASA,SAASE,YAAT,GAAwB;MACpB,MAAMC,UAAU,GAAGN,QAAQ,GAAGN,OAA9B;MACA,MAAMa,GAAG,GAAGZ,SAAS,CAACY,GAAV,EAAZ;;MACA,IAAIA,GAAG,GAAGD,UAAV,EAAsB;QAClBR,UAAU,GAAG,KAAKU,QAAL,CAAcC,SAAd,EAAyBH,UAAU,GAAGC,GAAtC,CAAb;QACAV,UAAU,CAACa,GAAX,CAAeZ,UAAf;QACA;MACH;;MACDG,IAAI;IACP;;IACDL,MAAM,CAACe,SAAP,CAAiBnB,6EAAwB,CAACK,UAAD,EAAcM,KAAD,IAAW;MAC7DJ,SAAS,GAAGI,KAAZ;MACAH,QAAQ,GAAGL,SAAS,CAACY,GAAV,EAAX;;MACA,IAAI,CAACT,UAAL,EAAiB;QACbA,UAAU,GAAGH,SAAS,CAACa,QAAV,CAAmBH,YAAnB,EAAiCX,OAAjC,CAAb;QACAG,UAAU,CAACa,GAAX,CAAeZ,UAAf;MACH;IACJ,CAPwC,EAOtC,MAAM;MACLG,IAAI;MACJJ,UAAU,CAACe,QAAX;IACH,CAVwC,EAUtCH,SAVsC,EAU3B,MAAM;MAChBV,SAAS,GAAGD,UAAU,GAAG,IAAzB;IACH,CAZwC,CAAzC;EAaH,CApCa,CAAd;AAqCH;;;;;;;;;;;;;;;;;ACzCD;AACA;AACA;AACO,SAASgB,oBAAT,CAA8BC,UAA9B,EAA0CC,WAAW,GAAGH,oDAAxD,EAAkE;EACrEE,UAAU,GAAGA,UAAU,KAAK,IAAf,IAAuBA,UAAU,KAAK,KAAK,CAA3C,GAA+CA,UAA/C,GAA4DE,cAAzE;EACA,OAAO1B,mDAAO,CAAC,CAACK,MAAD,EAASC,UAAT,KAAwB;IACnC,IAAIqB,WAAJ;IACA,IAAIC,KAAK,GAAG,IAAZ;IACAvB,MAAM,CAACe,SAAP,CAAiBnB,6EAAwB,CAACK,UAAD,EAAcM,KAAD,IAAW;MAC7D,MAAMiB,UAAU,GAAGJ,WAAW,CAACb,KAAD,CAA9B;;MACA,IAAIgB,KAAK,IAAI,CAACJ,UAAU,CAACG,WAAD,EAAcE,UAAd,CAAxB,EAAmD;QAC/CD,KAAK,GAAG,KAAR;QACAD,WAAW,GAAGE,UAAd;QACAvB,UAAU,CAACO,IAAX,CAAgBD,KAAhB;MACH;IACJ,CAPwC,CAAzC;EAQH,CAXa,CAAd;AAYH;;AACD,SAASc,cAAT,CAAwBI,CAAxB,EAA2BC,CAA3B,EAA8B;EAC1B,OAAOD,CAAC,KAAKC,CAAb;AACH","sources":["./src/app/home/book-preview/book-preview.component.ts","./src/app/home/book-preview/book-preview.component.html","./src/app/home/home-page/home-page.component.ts","./src/app/home/home-page/home-page.component.html","./src/app/home/home.module.ts","./src/app/shared/services/user-preferences/user-preferences.service.ts","./node_modules/rxjs/dist/esm/internal/operators/debounceTime.js","./node_modules/rxjs/dist/esm/internal/operators/distinctUntilChanged.js"],"sourcesContent":["import Book from '../../shared/backend/book/book.model';\nimport { Component, Input } from '@angular/core';\n\n@Component({\n    selector: 'app-book-preview',\n    templateUrl: './book-preview.component.html',\n    styleUrls: ['./book-preview.component.css']\n})\nexport class BookPreviewComponent {\n    \n    @Input() book: Book | undefined;\n    \n    get priceInCentavos(): string {\n        if(!this.book) return \"\";\n\n        return `${Math.floor((this.book.price - Math.floor(this.book.price))*100)}`.padEnd(2, \"0\");\n    }\n\n    get priceInReal(): number {\n        if(!this.book) return 0;\n\n        return Math.floor(this.book.price);\n    }\n\n}\n","<ng-container *ngIf=\"this.book\">\n    <div class=\"book-cover\">\n        <img alt=\"Capa do livro\" [src]=\"this.book.bookCoverUrl\">\n    </div>\n    <div class=\"book-data\">\n        <div class=\"book-data__name-and-author\">\n            <span class=\"book-data__name text-preset-430\">{{this.book.title}}</span>\n            <span class=\"book-data__author text-preset-350\">{{this.book.author}}</span>\n        </div>\n        <span class=\"book-data__price text-preset-430\">R$ {{this.priceInReal}}<span class=\"text-preset-230\">,{{this.priceInCentavos}}</span></span>\n        <span class=\"book-data__out-of-stock text-preset-350\" *ngIf=\"this.book.quantity === 0\">Fora de estoque</span>\n    </div>\n</ng-container>","import Book from 'src/app/shared/backend/book/book.model';\nimport { BookService } from 'src/app/shared/backend/book/book.service';\nimport { Component } from '@angular/core';\nimport { UserPreferencesService } from 'src/app/shared/services/user-preferences/user-preferences.service';\nimport { debounceTime, distinctUntilChanged, filter, of, switchMap } from 'rxjs';\n\n@Component({\n    selector: 'app-home-page',\n    templateUrl: './home-page.component.html',\n    styleUrls: ['./home-page.component.css']\n})\nexport class HomePageComponent {\n    \n    books: Book[] = [];\n    canLoadMore: boolean = false;\n    filteredBooks: Book[] | undefined;\n    private readonly _pageSize: number = 6;\n\n    constructor(\n        private bookService: BookService,\n        private userPreferencesService: UserPreferencesService\n    ) {\n        this.loadMore();\n    }\n\n    get showWelcomeModal(): boolean {\n        return this.userPreferencesService.userPreferences.showWelcomeModal;\n    }\n\n    closeButtonClick(): void {\n        this.userPreferencesService.setProperty(\"showWelcomeModal\", false);\n    }\n\n    loadMore(): void {\n        this.bookService.readAll(this.books.length/this._pageSize).subscribe(x => {\n            if(x !== undefined) {\n                this.books.push(...x);\n                this.canLoadMore = x.length === 6;\n            }\n        });\n    }\n\n    onSearch(event: Event): void {\n        const value: string = (event.target as HTMLInputElement).value\n\n        if(value.length < 2) {\n            this.filteredBooks = undefined;\n            return;\n        }\n\n        of(value).pipe(\n            debounceTime(250),\n            distinctUntilChanged(),\n            switchMap(searchTerm => this.bookService.filter(searchTerm))\n        ).subscribe(x => {\n            this.filteredBooks = x;\n        })\n    }\n\n}\n","<app-default-page>\n    <div class=\"search\">\n        <span class=\"text-preset-650 welcome-message\">Boas-vindas! Faça a busca pelo nome do livro ou autor(a)</span>\n        <div class=\"search-group\">\n            <app-field (onFieldInput)=\"this.onSearch($event)\"></app-field>\n        </div>\n    </div>\n    <div class=\"books\">\n        <app-book-preview\n            [book]=\"book\"\n            *ngFor=\"let book of (this.filteredBooks ?? this.books)\"\n            [routerLink]=\"'/book/' + book.id\"\n        ></app-book-preview>\n    </div>\n    <span\n        class=\"load-more text-preset-460\"\n        (click)=\"this.loadMore()\"\n        *ngIf=\"this.canLoadMore && this.filteredBooks === undefined\"\n    >Carregar mais</span>\n</app-default-page>\n<app-modal\n    (closeButtonClick)=\"this.closeButtonClick()\"\n    [closeButtonLabel]=\"'Entendido'\"\n    [textContent]=\"'Esse aplicativo é uma demo de um e-commerce de livros. Por ser uma demo, as compras não podem ser concluídas, mas, você pode adicionar itens ao carrinho, fornecer um endereço de entrega e escolher um método de pagamento.\\n\\nOs dados dos livros foram retirados da amazon no dia 28/07/2022'\"\n    [title]=\"'Boas vindas!'\"\n    *ngIf=\"this.showWelcomeModal\"\n></app-modal>","import { BookPreviewComponent } from './book-preview/book-preview.component';\nimport { HomePageComponent } from './home-page/home-page.component';\nimport { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { SharedModule } from '../shared/shared.module';\n\nconst homeRoutes: Routes = [\n    {\n        component: HomePageComponent,\n        path: \"\"\n    }\n];\n\n@NgModule({\n    declarations: [\n        BookPreviewComponent,\n        HomePageComponent\n    ],\n    imports: [\n        RouterModule.forChild(homeRoutes),\n        SharedModule\n    ]\n})\nexport class HomeModule { }\n","import { Injectable } from '@angular/core';\nimport UserPreferences from './user-preferences.model';\n\nconst defaultUserPreferences: UserPreferences = {\n    showWelcomeModal: true\n}\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class UserPreferencesService {\n    \n    public readonly userPreferencesKey: string = \"user-preferences\";\n\n    constructor() {\n        const userPreferencesString: null | string = localStorage.getItem(this.userPreferencesKey);\n        let userPreferences: UserPreferences;\n\n        if(userPreferencesString === null) {\n            userPreferences = defaultUserPreferences;\n        }\n        else {        \n            userPreferences = JSON.parse(userPreferencesString);\n            let key: keyof typeof defaultUserPreferences;\n    \n            // After an update on user preferences, if a new key is create, it will be assigned to the\n            // already existing preferences.\n            for(key in defaultUserPreferences) {\n                if(!Object.keys(userPreferences).includes(key)) {\n                    userPreferences[key] = defaultUserPreferences[key];\n                }\n            }\n        }\n\n        localStorage.setItem(this.userPreferencesKey, JSON.stringify(userPreferences));\n    }\n\n    get userPreferences(): UserPreferences {\n        // The object will not return null, because it's initialized in the service constructor\n        return JSON.parse(localStorage.getItem(this.userPreferencesKey)!)\n    }\n\n    setProperty<K extends keyof UserPreferences>(propertyName: K, value: UserPreferences[K]) {\n        const userPreferences = this.userPreferences;\n        userPreferences[propertyName] = value;\n\n        localStorage.setItem(this.userPreferencesKey, JSON.stringify(userPreferences));\n    }\n\n}\n","import { asyncScheduler } from '../scheduler/async';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function debounceTime(dueTime, scheduler = asyncScheduler) {\n    return operate((source, subscriber) => {\n        let activeTask = null;\n        let lastValue = null;\n        let lastTime = null;\n        const emit = () => {\n            if (activeTask) {\n                activeTask.unsubscribe();\n                activeTask = null;\n                const value = lastValue;\n                lastValue = null;\n                subscriber.next(value);\n            }\n        };\n        function emitWhenIdle() {\n            const targetTime = lastTime + dueTime;\n            const now = scheduler.now();\n            if (now < targetTime) {\n                activeTask = this.schedule(undefined, targetTime - now);\n                subscriber.add(activeTask);\n                return;\n            }\n            emit();\n        }\n        source.subscribe(createOperatorSubscriber(subscriber, (value) => {\n            lastValue = value;\n            lastTime = scheduler.now();\n            if (!activeTask) {\n                activeTask = scheduler.schedule(emitWhenIdle, dueTime);\n                subscriber.add(activeTask);\n            }\n        }, () => {\n            emit();\n            subscriber.complete();\n        }, undefined, () => {\n            lastValue = activeTask = null;\n        }));\n    });\n}\n","import { identity } from '../util/identity';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function distinctUntilChanged(comparator, keySelector = identity) {\n    comparator = comparator !== null && comparator !== void 0 ? comparator : defaultCompare;\n    return operate((source, subscriber) => {\n        let previousKey;\n        let first = true;\n        source.subscribe(createOperatorSubscriber(subscriber, (value) => {\n            const currentKey = keySelector(value);\n            if (first || !comparator(previousKey, currentKey)) {\n                first = false;\n                previousKey = currentKey;\n                subscriber.next(value);\n            }\n        }));\n    });\n}\nfunction defaultCompare(a, b) {\n    return a === b;\n}\n"],"names":["asyncScheduler","operate","createOperatorSubscriber","debounceTime","dueTime","scheduler","source","subscriber","activeTask","lastValue","lastTime","emit","unsubscribe","value","next","emitWhenIdle","targetTime","now","schedule","undefined","add","subscribe","complete","identity","distinctUntilChanged","comparator","keySelector","defaultCompare","previousKey","first","currentKey","a","b"],"sourceRoot":"webpack:///"}